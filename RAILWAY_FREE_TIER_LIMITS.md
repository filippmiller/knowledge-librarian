# Railway Free Tier Memory Limitations

## Current Situation

Railway free tier –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç **512MB RAM**, —á—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –º–∞–ª–æ –¥–ª—è AI-–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

## –ü—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (EXTREME)

### ‚úÖ 1. JSON Parser Fix
- **–ü—Ä–æ–±–ª–µ–º–∞**: AI –≤–æ–∑–≤—Ä–∞—â–∞–ª `***json` –≤–º–µ—Å—Ç–æ ` ```json`
- **–†–µ—à–µ–Ω–∏–µ**: –†–∞—Å—à–∏—Ä–µ–Ω regex –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö markdown –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
- **–§–∞–π–ª**: `src/lib/ai/chat-provider.ts`
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

### ‚úÖ 2. Batch Processing
- **–î–æ**: 12000 —Å–∏–º–≤–æ–ª–æ–≤ –∑–∞ —Ä–∞–∑
- **–ü–æ—Å–ª–µ**: 1000 —Å–∏–º–≤–æ–ª–æ–≤ –∑–∞ —Ä–∞–∑ (—É–º–µ–Ω—å—à–µ–Ω–æ –≤ **12 —Ä–∞–∑**)
- **–§–∞–π–ª**: `src/lib/ai/knowledge-extractor-stream.ts`
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–†–ò–ú–ï–ù–ï–ù–û

### ‚úÖ 3. Embedding Processing
- **–î–æ**: 5 embeddings –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- **–ü–æ—Å–ª–µ**: 1 embedding –∑–∞ —Ä–∞–∑ (–º–∏–Ω–∏–º—É–º –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ)
- **–§–∞–π–ª**: `src/lib/ai/chunker.ts`
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–†–ò–ú–ï–ù–ï–ù–û

### ‚úÖ 4. Garbage Collection
- **–î–æ–±–∞–≤–ª–µ–Ω–æ**: `global.gc()` –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã
- **ENV**: `NODE_OPTIONS=--max-old-space-size=4096 --expose-gc`
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –£–°–¢–ê–ù–û–í–õ–ï–ù–û

### ‚úÖ 5. Resume Capability
- **–§—É–Ω–∫—Ü–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ crash
- **–§–∞–π–ª**: `src/app/api/documents/[id]/process-stream/route.ts`
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –£–ñ–ï –†–ê–ë–û–¢–ê–ï–¢

## –ü—Ä–æ–±–ª–µ–º–∞

–î–∞–∂–µ —Å–æ –í–°–ï–ú–ò –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏, Railway free tier –≤—Å–µ –µ—â–µ –ø–∞–¥–∞–µ—Ç —Å 502 OOM:

```
Application failed to respond - 502
```

**–ü—Ä–∏—á–∏–Ω–∞**: 512MB RAM –ø—Ä–æ—Å—Ç–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è:
- Node.js runtime (~100MB)
- Next.js framework (~150MB)
- Prisma ORM (~50MB)
- AI processing + –¥–æ–∫—É–º–µ–Ω—Ç (~200MB+)
- = **500MB+ –º–∏–Ω–∏–º—É–º**

## –†–µ—à–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: Railway Pro Plan (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
**–°—Ç–æ–∏–º–æ—Å—Ç—å**: ~$5-10/–º–µ—Å—è—Ü
**RAM**: 1-2GB
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞ –Ω–∞ 100%

```bash
# Upgrade —á–µ—Ä–µ–∑ Railway dashboard:
https://railway.app/account/billing
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

#### A) Render.com
- **Free tier**: 512MB RAM (—Ç–∞–∫–∞—è –∂–µ –ø—Ä–æ–±–ª–µ–º–∞)
- **Starter**: $7/–º–µ—Å—è—Ü, 512MB RAM
- **Standard**: $25/–º–µ—Å—è—Ü, 2GB RAM ‚úÖ

#### B) Fly.io
- **Free**: 256MB RAM (—Ö—É–∂–µ)
- **Paid**: ~$5/–º–µ—Å—è—Ü –∑–∞ 1GB RAM ‚úÖ

#### C) DigitalOcean App Platform
- **Basic**: $5/–º–µ—Å—è—Ü, 512MB RAM
- **Pro**: $12/–º–µ—Å—è—Ü, 1GB RAM ‚úÖ

#### D) Vercel (Next.js native)
- **Hobby**: Free, –Ω–æ Function timeout 10s (–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)
- **Pro**: $20/–º–µ—Å—è—Ü, 50s timeout ‚úÖ

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å (–°–õ–û–ñ–ù–û)

–ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É:
1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ ‚Üí –æ—á–µ—Ä–µ–¥—å (Redis/BullMQ)
2. Background worker –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
3. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ DB
4. Frontend polling –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞

**–ú–∏–Ω—É—Å—ã**:
- –¢—Ä–µ–±—É–µ—Ç —Ä–µ–¥–∏–∑–∞–π–Ω –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- –ù—É–∂–µ–Ω Redis/queue service
- –ù–µ—Ç real-time streaming
- ~40-60 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã

### –í–∞—Ä–∏–∞–Ω—Ç 4: –õ–æ–∫–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–ù–ï SCALABLE)

–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ:
```bash
npm run dev  # –õ–æ–∫–∞–ª—å–Ω–æ
```

**–ú–∏–Ω—É—Å—ã**:
- –ù–µ production-ready
- –¢—Ä–µ–±—É–µ—Ç –∑–∞–ø—É—â–µ–Ω–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä 24/7

## –§–∏–Ω–∞–ª—å–Ω–∞—è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

üéØ **Railway Pro Plan ($5-10/–º–µ—Å) —Å 1-2GB RAM**

**–ü–æ—á–µ–º—É:**
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ (1 –∫–ª–∏–∫)
- ‚úÖ 100% —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ç–µ–∫—É—â–∏–º –∫–æ–¥–æ–º
- ‚úÖ Real-time streaming —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –í—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- ‚úÖ –î–µ—à–µ–≤–æ ($5-10/–º–µ—Å)

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:**
- Fly.io ($5/–º–µ—Å –∑–∞ 1GB RAM)
- DigitalOcean App Platform ($12/–º–µ—Å –∑–∞ 1GB RAM)

## Current Status

**–í—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã:**
- ‚úÖ Batch size: 1000 chars
- ‚úÖ Embedding: 1 at a time
- ‚úÖ GC enabled
- ‚úÖ JSON parser fixed
- ‚úÖ Resume capability works

**–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ç–µ—Å—Ç:**
- ‚úÖ –§–∞–∑–∞ 1 (Domain Classification) - –Ω–∞—á–∞—Ç–∞
- ‚úÖ –§–∞–∑–∞ 2 (Knowledge Extraction) - –Ω–∞—á–∞—Ç–∞
- ‚ùå OOM –ø–æ—Å–ª–µ –§–∞–∑—ã 2

**Next Step:**
Upgrade Railway to Pro plan –¥–ª—è 1-2GB RAM.
